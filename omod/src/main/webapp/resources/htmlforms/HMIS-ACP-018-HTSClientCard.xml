<htmlform formName="HMIS ACP 018:HTS Client Card"
          formDescription="HIV Testing Services Client Card"
          formEncounterType="264daIZd-f80e-48fe-nba9-P37f2W1905Pv"
          formUuid="b5c62a98-84d3-43e8-a9be-972185070dd4"
          formVersion="1.2"
          formAddMetadata="yes"
          formUILocation="patientDashboard.visitActions"
          formOrder="6"
          formIcon="icon-medkit"
          formShowIf="(visit.active || !visit.active) &amp;&amp; patient.person.dead==false"
          formDisplayStyle="Standard"
          formLabel="HTS Client Card">
    <script type="text/javascript">

        var facility_entry_point ;
        var facility_entry_point_enabled =false;
        var community_entry_testing_point ;
        var community_entry_testing_point_enabled = false;

        if (jQuery) {
            jq(document).ready(function () {

                //Block Multiple encounter entry on same date
                blockEncounterOnSameDateEncounter(jq("#encounterDate").find("input[type=hidden]"),"block");

            <ifMode mode="EDIT">
                if( jq("#165160").find("input").val()==''){
                disable_fields(165160);
                }
                if( jq("#99416").find("input").val()==''){
                disable_fields(99416);
                }
                if( jq("#162925").find("input").val()==''){
                    disable_fields(162925);
                }
                if( jq("#90211").find("input").val()==''){
                    disable_fields(90211);
                }
                if( jq("#99115").find("input").val()==''){
                    disable_fields(99115);
                }
                if( jq("#165159").find("input").val()==''){
                    disable_fields(165159);
                }
                if( jq("#165167").find("input").val()==''){
                    disable_fields(165167);
                }
                if( jq("#141520").find("input").val()==''){
                    disable_fields(141520);
                }
                if(jq("#165182").find("input[type$='radio']").val()==''){
                    jq("#165182").find("input[type$='radio']").attr("disabled",true);
                }

              if( jq("#99369").find("input[type$='text']").val()==''){
                jq("#99369").find("input[type$='text']").attr("disabled",true);
              }
              if(jq("#99477").find("input[type$='radio']").val()==''){
                  jq("#99477").find("input[type$='radio']").attr("disabled",true);
              }
              if(jq("#99481").find("input[type$='radio']").val()==''){
                  jq("#99481").find("input[type$='radio']").attr("disabled",true);
              }
              if(jq("#165178").find("input[type$='radio']").val()==''){
                  jq("#165178").find("input[type$='radio']").attr("disabled",true);
              }
              if(jq("#165175").find("input[type$='text']").val()==''){
                  jq("#165175").find("input[type$='text']").attr("disabled",true);
              }
              if(jq("#other-special-category").find("input[type$='text']").val()==''){
                  jq("#other-special-category").find("input[type$='text']").attr("disabled",true);
              }
              if(jq("#165170").find("input[type$='text']").val()==''){
                    jq("#165170").find("input[type$='text']").attr("disabled",true);
               }
              if(jq("#165918").find("input[type$='text']").val()==''){
                jq("#165918").find("input[type$='text']").attr("disabled",true);
                }
                if(jq("#166758").find("input[type$='text']").val()==''){
                jq("#166758").find("input[type$='text']").attr("disabled",true);
                }
              if(jq("#165181").find("input[type$='radio']").val()==''){
                    jq("#165181").find("input[type$='radio']").attr("disabled",true);
              }
              if(jq("#162965").find("input[type$='text']").val()==''){
                    jq("#162965").find("input[type$='text']").attr("disabled",true);
              }
              if(jq("#165184").find("input[type$='text']").val()==''){
                    jq("#165184").find("input[type$='text']").attr("disabled",true);
              }

                if(jq("#856").find("input[type$='text']").val()==''){
                jq("#856").find("input[type$='text']").attr("disabled",true);
                }
                if(jq("#1305").find("input[type$='radio']").val()==''){
                jq("#1305").find("input[type$='radio']").attr("disabled",true);
                }
                if(jq("#165845").find("input[type$='text']").val()==''){
                jq("#165845").find("input[type$='text']").attr("disabled",true);
                }
            </ifMode>

                disable_fields(856);
                disable_fields(1305);
                disable_fields(165845);

                disable_fields(165160);
                disable_fields(162925);
                disable_fields(90211);
                disable_fields(99369);
                disable_fields(99115);
                disable_fields(165159);
                disable_fields(165167);
                disable_fields(141520);
                disable_fields(165184);
                disable_fields(165182);
                disable_fields(9477);
                disable_fields(99481);
                disable_fields(165178);
                disable_fields(165175);
                disable_fields(165170);
                disable_fields(165918);
                disable_fields(166758);
                disable_fields(162965);
                disable_fields(165181);
                disable_fields("other-special-category");
                jq(".reason_for_testing_cict").hide()
                jq(".reason_for_testing_pitc").hide()

                <!-- Display reason for testing based on CICT/PITC hts approach -->
                jq("#hts-approach").change(function () {
                    if(jq(this).find("input[type$='radio']:checked").val()==162919) {
                        jq(".reason_for_testing_cict").show()
                        jq(".reason_for_testing_pitc").hide()
                        disable_fields(165167)
                    }
                    else {
                        jq(".reason_for_testing_cict").hide()
                        jq(".reason_for_testing_pitc").show()
                        disable_fields(165167)
                    }
                });

                jq(".reason_for_testing_cict").change(function () {
                    if(jq(this).find(":selected").val()==90002)
                        enable_fields(165167)
                    else
                        disable_fields(165167)
                });

                <!-- Enable HTC Delivery Model-->
                jq("#165171").change(function () {
                var hts_Delivery_Model  = getValue('165171.value');

                if(hts_Delivery_Model == 99416 ){
                    disable_fields(165160);
                    enable_fields(162925);
                    disable_fields(165159);
                    facility_entry_point_enabled= true;
                    community_entry_testing_point_enabled= false;
                }
                else if(hts_Delivery_Model == 165160){
                    disable_fields(162925);
                    enable_fields(165160);
                    disable_fields(99115);
                    community_entry_testing_point_enabled= true;
                    facility_entry_point_enabled= false;
                }
                else{
                    disable_fields(165160);
                    disable_fields(162925);
                }
                });

                <!-- Enable place of referral -->
                jq('#162982').change(function () {
                    if(getValue('162982' + '.value')== 1065)
                        enable_fields(90211);
                    else
                        disable_fields(90211);
                });

                <!-- Enable Viral Load Recency  -->
                jq('#99481').change(function () {
                    if(getValue('99481' + '.value')== 1065)
                        enable_fields(856);
                    else
                        disable_fields(856);
                });

                <!-- Enable Vl undetectable  -->
                jq('#99481').change(function () {
                    if(getValue('99481' + '.value')== 1065)
                        enable_fields(1305);
                    else
                        disable_fields(1305);
                });
                <!-- Enable Recency Sample ID  -->
                jq('#99481').change(function () {
                    if(getValue('99481' + '.value')== 1065)
                        enable_fields(165845);
                    else
                        disable_fields(165845);
                });
                <!-- Enable HIV Test date -->
                jq('#165180').change(function () {
                    if(getValue('165180' + '.value')== 90004) {
                        enable_fields(165170);
                        enable_fields(165181);
                        enable_fields(162965);
                        enable_fields(166758);
                        enable_fields(165918);
                    }
                    else {
                        disable_fields(165170);
                        disable_fields(165181);
                        disable_fields(162965);
                        disable_fields(166758);
                        disable_fields(166758);

        }
                });

                <!--Enable HIV spouse test field-->
                jq('#99472').change(function () {
                    if(getValue('99472' + '.value')== 1065)
                        enable_fields(99477);
                    else
                        disable_fields(99477);
                });

                jq('#165169').change(function () {
                    if(getValue('165169' + '.value')== 90002)
                        enable_fields(165184);
                    else
                        disable_fields(165184);
                });

                <!--Enable pre test counselling-->
                jq('#162918').change(function () {
                    if(getValue('162918' + '.value')== 90003)
                        enable_fields(99368);
                    else
                        disable_fields(99368);
                });

                <!--Enable Results received as a couple -->
                jq('#99494').change(function () {
                    if(getValue('99494' + '.value')== 1065)
                        enable_fields(99497);
                    else
                        disable_fields(99497);
                });

                <!-- other specify handling -->
                jq('#969').change(function () {
                    if(getValue('969' + '.value')== 5620)
                        enable_fields(99369);
                    else
                        disable_fields(99369);
                });

                jq('#162925').change(function () {
                    if(getValue('162925' + '.value')== 90002)
                        enable_fields(99115);
                    else
                        disable_fields(99115);
                });

                jq('#165160').change(function () {
                    if(getValue('165160' + '.value')== 90002)
                        enable_fields(165159);
                    else
                        disable_fields(165159);
                });

                jq('#165168').change(function () {
                    if(getValue('165168' + '.value')== 90002)
                        enable_fields(165167);
                    else
                        disable_fields(165167);
                });

                <includeIf velocityTest="$fn.globalProperty('ugandaemr.hts.recency') == true">
                    <excludeIf velocityTest="$patient.age &lt; 15">

                        jq('#99493').change(function () {
                            if(getValue('99493' + '.value')== 90166)
                                enable_fields(99481);
                            else
                                disable_fields(99481);
                        });

                    </excludeIf>
                </includeIf>

                jq('#99498').change(function () {
                    if(getValue('99498' + '.value')== 1065)
                        enable_fields(165178);
                    else
                        disable_fields(165178);
                });

                jq('#form-id').change(function () {
                    if(getValue('99493' + '.value')== 90166 ){
                        enable_fields('99493');
                        enable_fields('165182');
                        if( getValue('99481' + '.value')== 1065){
                            enable_fields(141520);
                            enable_fields(856);
                            enable_fields(1305);
                            enable_fields(165845);
                        }
                        else if( getValue('99481' + '.value')== 1066){
                            disable_fields(141520);
        disable_fields(856);
        disable_fields(1305);
        disable_fields(165845);
                        }else{
                            disable_fields(141520);
        disable_fields(856);
        disable_fields(1305);
        disable_fields(165845);
                        }
                    }else{
                        disable_fields(141520);
                        disable_fields('165182');
        disable_fields(856);
        disable_fields(1305);
        disable_fields(165845);
                    }
                });

                jq('#other-prevention-services').change(function(){
                    if(!jq('#other-prevention-services').find(':checkbox').prop('checked')){
                        jq("#165175").find("input[type$='text']").attr("disabled",true);
                        jq("#165175").find("input[type$='text']").val("");
                    }
                    else
                        enable_fields(165175);
                });

                jq('#other-special-category').change(function(){
                    if(!jq('#other-special-category').find(':checkbox').prop('checked')){
                        jq("#other-special-category").find("input[type$='text']").attr("disabled",true);
                        jq("#other-special-category").find("input[type$='text']").val("");
                    }else{
                        jq("#other-special-category").find("input[type$='text']").attr("disabled",false); }
                });

                /* add JQuery validator classes and rules*/
                jq("#nationalid input:text").addClass("nationalid");

                /* add the validator on the beforeSubmit*/
                beforeSubmit.push(function () {
                        jq("#htmlform").validate();
                        return jq("#htmlform").valid();
                    }
                );

            });

            function disable_fields(groupId){
                var disable = true;
                var group = jq("#"+groupId);
                group.find("input").attr("disabled", disable);
                group.find('select').attr("disabled", disable);

                if (disable) {
                    /* fade out the fields that are disabled */
                    group.find("input").fadeTo(250, 0.25);
                    group.find("select").fadeTo(250, 0.25);
                } else {
                    /* remove the fade on the fields */
                    group.find("input").fadeTo(250, 1);
                    group.find("select").fadeTo(250, 1);
                }
            }

            function enable_fields(group){
                var disable = false;
                var group = jq("#"+group);
                group.find("input").attr("disabled", disable);
                group.find('select').attr("disabled", disable);

                if (!disable) {
                    /* remove the fade on the fields */
                    group.find("input").fadeTo(250, 1);
                    group.find("select").fadeTo(250, 1);
                }
            }

            function enable_disable(triggerId, enabledDisabledId, conditionValue) {
                if (getValue(triggerId + '.value') == conditionValue){

                    enableContainer('#' + enabledDisabledId);
                }
                else {
                    if(getValue(enabledDisabledId+'.value')!=''){
                        setValue(enabledDisabledId+'.value', '');
                    }
                    disableContainer('#' + enabledDisabledId);
                }

            }

            beforeSubmit.push(function () {
                setValue('162925.error', '');
                setValue('165160.error', '');
                setValue('99115.error', '');
                setValue('165159.error', '');
                setValue('165167.error', '');

                var submitVal = true;
                var submitValStage = [];
               if( jq("#162925").find("select").find(":selected").val()== '' &amp;&amp; facility_entry_point_enabled ){
                   getField('162925.error').html('Select one of the options ').show();
                   return false;
               }
               if( jq("#165160").find("select").find(":selected").val()== '' &amp;&amp; community_entry_testing_point_enabled ){
                  getField('165160.error').html('Select one of the options ').show();
                  return false;
               }
               if(! jq("#162925").find("select").is(':disabled') &amp;&amp; jq("#162925").find("select").find(":selected").val()== 90002 &amp;&amp; jq("#99115").find("input[type$='text']").val()=='') {
                   getField('99115.error').html('Required text field is empty').show();
                   return false;
               }
               if(! jq("#165160").find("select").is(':disabled') &amp;&amp; jq("#165160").find("select").find(":selected").val()== 90002 &amp;&amp; jq("#165159").find("input[type$='text']").val()=='') {
                    getField('165159.error').html('Required text field is empty').show();
                    return false;
               }
               if(! jq("#165168").find("select").is(':disabled') &amp;&amp; jq("#165168").find("select").find(":selected").val()== 90002 &amp;&amp; jq("#165167").find("input[type$='text']").val()=='') {
                    getField('165167.error').html('Required text field is empty').show();
                    return false;
               }

                return true;
            });
        }

    </script>

<div id="form-id">
    <div class="row">
        <div class="col-md-6">
            <h1>HMIS ACP 018: HTS CLIENT CARD</h1>
        </div>
        <div class="col-md-5"></div>
        <div class="col-md-1">
            <submit class="confirm" submitLabel="Save" submitStyle="customSubmit" />
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header">
                    <ul class="nav nav-tabs nav-fill card-header-tabs">
                        <li class="nav-item">
                            <a class="nav-link active" data-toggle="tab" href="#visit-details">Visit Details</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#risk-assessment">HIV Risk Assessment</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#hiv-test-result">HIV Test Results</a>
                        </li>
                    </ul>
                </div>
                <div class="card-body">
                    <div class="tab-content">
                        <div class="tab-pane active" id="visit-details">
                            <div class="card">
                                <div class="card-header">
                                    Visit Details
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-4">
                                            <label>Date</label>
                                            <encounterDate default="today" disallowMultipleEncountersOnDate="block"/>
                                            <span style="display: none;">
                                                <encounterLocation default="629d78e9-93e5-43b0-ad8a-48313fd99117"
                                                                   order="629d78e9-93e5-43b0-ad8a-48313fd99117"/>
                                            </span>
                                        </div>
                                        <div class="col-md-4">
                                            <label>Serial number</label>
                                            <obs conceptId="1646" required="true"/>
                                        </div>

                                        <includeIf velocityTest="$patient.age &lt; 12">
                                        <div class="col-md-4">
                                            <label>Accompanied by</label>
                                            <obs id="969" conceptId="969" answerConceptIds="970,971,165154,5620"
                                                 answerLabels="1 - Mother,2 - Father,3 - Both Parents, 4 - Other " style="radio"/>
                                            <span >

                                                <label>Specify</label>
                                                <obs id="99369" conceptId="99369" class="horizontal-layout-options"/>

                                            </span>
                                        </div>
                                        </includeIf>

                                    </div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="card-header">
                                    Delivery Model
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-4">
                                            <label>HTS delivery model</label>
                                            <obs id="165171" conceptId="165171" answerConceptIds="99416,165160" answerLabels="1 - Health Facility(HF),2 - Community " style="radio" required="true" class="horizontal"/>
                                        </div>
                                        <div class="col-md-4">
                                            <label>HTS Approach</label>
                                            <obs id="hts-approach" conceptId="99462" answerConceptIds="162919,99459" answerLabels="1 - CICT/VCT,2 - PITC" style="radio" required="true" class="horizontal"/>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="card">
                                <div class="card-header">
                                   Entry point for testing
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-4">
                                            <label> Entry point for health facility testing</label>
                                                    <obs conceptId="162925" id="162925"
                                                         answerConceptIds="160542,165179,165047,165048,165156,99593,164983,160456,165046,164984,90015,90002"
                                                         answerLabels="1 - OPD, 2 - Ward,3 - ART Clinic,4 - TB Clinic,5 - Nutrition unit,6 - Young Child Clinic (YCC),7 - ANC,8 - Maternity,9 - PNC,10 - Family Planning,12 - STI Clinic,13 - Others (specify)">
                                                        <controls>
                                                            <when value="90002" thenDisplay="#entry-point-other-specify" />
                                                            <when value="164983" thenDisplay="#anc-visit-number" />
                                                        </controls>
                                                    </obs>
                                        </div>
                                        <div class="col-md-4">
                                            <label> Entry point for community health testing</label>
                                            <span id="checkboxRadio">
                                                <obs conceptId="165160" id="165160"
                                                     answerConceptIds="99460,165157,162920,162895,165158,90002"
                                                     answerLabels="1 - Home Based,2 - Hotspot,3 - Workplace,4 - Outreach,5 - Drop in Centre (DIC),6 - Others "/>
                                            </span>
                                        </div>
                                        <div class="col-md-4">
                                                <label>Other community entry point</label>
                                                <obs id="165159" conceptId="165159" class="horizontal-layout-options"/>
                                        </div>
                                        <div class="col-md-4">
                                            <span id="anc-visit-number">
                                                <label>ANC visit number</label>
                                                <obs conceptId="166517"
                                                     answerConceptIds="166508, 166509, 166507, 166510, 166511, 166512, 166513, 166514, 166515, 166516"
                                                     answerLabels="1st ANC visit, 2nd ANC visit, 3rd ANC visit, 4th ANC visit, 5th ANC visit,6th ANC visit, 7th ANC visit, 8th ANC visit, 9th ANC visit, 10th ANC visit" class="long-value-select"/>
                                            </span>
                                            <span id="entry-point-other-specify">
                                                <label>Other entry point</label>
                                                <obs id="99115" conceptId="99115" class="horizontal-layout-options"/>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="card-header">
                                    Reason for testing
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <label> Reason for testing</label>
                                            <span id="checkboxRadio" class="reason_for_testing_pitc">
                                                <obs conceptId="165168" id="165168"
                                                     answerConceptIds="165161,165162,165163,99056,165165,90012,90002, 166506"
                                                     answerLabels="1 - Assisted Partner Notification (APN),2 - Index Client Testing other than APN,
                                                                   3 - PrEP,4 - PEP,6 - Inconclusive HIV result,8 - PMTCT, 9 - Others, 10 - Social Network Strategy (SNS) "/>
                                            </span>
                                            <span id="checkboxRadio" class="reason_for_testing_cict">
                                                <obs conceptId="165168" id="165168"
                                                     answerConceptIds="165164,165166,90002"
                                                     answerLabels="5 - HIV Self -Test Positive,7 - Self-initiative,9 - Others"/>
                                            </span>
                                        </div>
                                        <div class="col-md-4">
                                            <label>Other reasons for testing</label>
                                            <obs id="165167" conceptId="165167" class="horizontal-layout-options"/>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <div class="tab-pane" id="risk-assessment" >
                            <div class="card">
                                <div class="card-header">
                                    Special categories
                                </div>
                                <div class="card-body symptoms">
                                    <div class="row ARTSpecialCateogryEnableDisable1">
                                        <div class="col-md-3">
                                            <obs conceptId="165169" answerConceptId="162277" answerLabel="1 - Prisoners" style="checkbox"/>
                                        </div>
                                        <div class="col-md-3">
                                            <obs conceptId="165169" answerConceptId="160666" answerLabel="2 - PWIDs"
                                                 style="checkbox"/>
                                        </div>
                                        <div class="col-md-3">
                                            <obs conceptId="165169" answerConceptId="165125"
                                                 answerLabel="3 - Uniformed Men" style="checkbox"/>
                                        </div>
                                        <div class="col-md-3">
                                            <obs conceptId="165169" answerConceptId="165126"
                                                 answerLabel="4 - Migrant workers" style="checkbox"/>
                                        </div>
                                    </div>
                                    <div class="row ARTSpecialCateogryEnableDisable1">
                                        <div class="col-md-3">
                                            <obs conceptId="165169" answerConceptId="162198"
                                                 answerLabel="5 - Truckers" style="checkbox"/>
                                        </div>
                                        <div class="col-md-3">
                                            <obs conceptId="165169" answerConceptId="159674"
                                                 answerLabel="6 - Fisher Folks" style="checkbox"/>
                                        </div>
                                        <div class="col-md-3">
                                            <obs conceptId="165169" answerConceptId="165127"
                                                 answerLabel="7 - Refugees" style="checkbox"/>
                                        </div>
                                        <div class="col-md-3">
                                            <obs conceptId="165169" answerConceptId="90041"
                                                 answerLabel="8 - Pregnant" style="checkbox"/>
                                        </div>
                                    </div>
                                    <div class="row ARTSpecialCateogryEnableDisable1">
                                        <div class="col-md-3">
                                            <obs conceptId="165169" answerConceptId="99601"
                                                 answerLabel="9 - Breastfeeding" style="checkbox"/>
                                        </div>
                                        <div class="col-md-3">
                                            <obs conceptId="165169" answerConceptId="165132" answerLabel="10 - AGYW"
                                                 style="checkbox"/>
                                        </div>
                                        <div class="col-md-3">
                                            <obs conceptId="165169" answerConceptId="162558"
                                                 answerLabel="11 - People with Disabilities" style="checkbox"/>
                                        </div>
                                        <div class="col-md-3">
                                            <obs conceptId="165169" id="165169" answerConceptId="90002"
                                                 answerLabel="12 - Others" style="checkbox"/>
                                            <span><label>Other special categories</label>
                                                <obs id="165184" conceptId="165184" class="ARTSpecialCateogryEnableDisableChild1"/>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                        </div>
                            <div class="card">
                                <div class="card-header">
                                    HIV Test History
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <label>First HIV test (has never tested before)</label>
                                            <obs id="165180" conceptId="165180" answerConceptIds="90003,90004" answerLabels="1 - Yes,2 - No" style="radio" class="horizontal"/>
                                        </div>
                                        <div class="col-md-3">
                                            <label>Last HIV visit date</label>
                                            <obs id="165170" conceptId="165170"/>
                                        </div>
                                        <div class="col-md-3">
                                            <label>Number of Months Since Last Tested</label>
                                            <obs id="165918" conceptId="165918"  class="horizontal"/>

                                        </div>
                                        <div class="col-md-3">
                                            <label>Previous test results</label>
                                            <obs id="165181" conceptId="165181" answerConceptIds="90166,90167" answerLabels="1 - Positive ,2 - Negative" style="radio" class="horizontal"/>

                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-3">
                                            <label>Previous Test Location</label>
                                            <obs id="166758" conceptId="166758"  class="horizontal"/>
                                        </div>

                                        <div class="col-md-3">
                                            <label>Times tested in last 12 Months</label>
                                            <obs id="162965" conceptId="162965"/>
                                        </div>

                                        <div class="col-md-3">
                                            <label>Number of sexual partners in the last 12 months</label>
                                            <obs conceptId="99463"/>
                                        </div>
                                        <div class="col-md-3">
                                            <label>Spouse/Partner ever been tested for HIV before</label>
                                            <obs id="99472" conceptId="99472" answerConceptIds="1065,1066,99480,1175" answerLabels="1 - Yes,2 - No,3 - Don't Know, 4 - Not Applicable" />
                                        </div>

                                    </div>

                                    <div class="row">
                                        <div class="col-md-4">
                                            <label>Recent partner test result</label>
                                            <obs id="99477" conceptId="99477" answerConceptIds="90166,90167,90001," answerLabels="1 - Positive ,2 - Negative ,3 - Don't know" style="radio" class="horizontal"/>
                                        </div>
                                        <div class="col-md-4">
                                            <label>Pre -Test Counseling done/information given</label>
                                            <obs id="162918" conceptId="162918" answerConceptIds="90003,90004" answerLabels="1 - Yes, 2 - No" style="radio" required="true" class="horizontal"/>
                                        </div>
                                        <div class="col-md-4">
                                            <label>Counseled as</label>
                                            <span class="CounseledAsCoupleEnableDisable1">
                                                <obs conceptId="99368" id="99368" answerConceptIds="99365,99367,99366"
                                                     answerLabels="1 - Individual,2 - Couple,3 - Group" style="radio" class="horizontal"/>
                                            </span>
                                        </div>

                                    </div>
                                </div>
                            </div>

                        </div>
                        <div class="tab-pane" id="hiv-test-result" >
                            <div class="card">
                                <div class="card-header">
                                    HIV Test Results
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-4">
                                            <label>HIV final test results</label>
                                            <obs id="99493" conceptId="99493" answerConceptIds="90167,90166,162926" answerLabels="1 - Negative,2 - Positive,3 - Inconclusive" style="radio" class="horizontal" required="true"/>
                                        </div>
                                        <includeIf velocityTest="$patient.gender == 'F'">
                                        <div class="col-md-4">
                                            <label>HIV final Syphillis-Duo results</label>
                                            <obs id="br" conceptId="165172" answerConceptIds="1228,1229" answerLabels="1 - Reactive,2 - Non-Reactive" style="radio" class="horizontal"/>

                                        </div>
                                        </includeIf>
                                    </div>
                                </div>
                                </div>
                            <includeIf velocityTest="$fn.globalProperty('ugandaemr.hts.recency') == true">
                                <excludeIf velocityTest="$patient.age &lt; 15">
                            <div class="card">
                                <div class="card-header">
                                    Recency Testing
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-4">
                                            <label>Do you agree to have blood drawn for recency?</label>
                                            <obs id="99481" conceptId="99481" answerConceptIds="1065,1066" answerLabels="1 - Yes,2 - No" style="radio" class="horizontal"/>
                                        </div>
                                        <div class="col-md-4">
                                            <label>HIV recency test result</label>
                                            <obs id="141520" conceptId="141520" answerConceptIds="141519,141518" answerLabels="1 - Long term infection ,2 - Recent infection"/>
                                        </div>

                                    </div>

                                    <div class="row">
                                        <div class="col-md-4">
                                            <label>HIV Recency Viral Load Result</label>
                                            <obs id="856"
                                                 conceptId="856"/>
                                        </div>

                                        <div class="col-md-4">
                                            <label></label>
                                            <obs id="1305" conceptId="1305" answerConceptIds="1306" answerLabels="VL undetectable" style="radio" class="horizontal"/>
                                        </div>
                                        <div class="col-md-4">
                                            <label>Receny Sample ID</label>
                                            <obs id="165845" conceptId="165845"/>
                                        </div>

                                    </div>
                                </div>
                            </div>
                                </excludeIf>
                            </includeIf>

                            <div class="card">
                                <div class="card-header">
                                    Other Testing Information
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <label>If tested HIV positive finger print has been  captured</label>
                                            <obs id="165182" conceptId="165182" answerConceptIds="1065,1066" answerLabels="1 - Yes,2 - No" style="radio" class="horizontal"/>
                                        </div>
                                            <div class="col-md-3">
                                                <label>Results received as individual</label>
                                                <obs conceptId="165183" answerConceptIds="1065,1066" answerLabels="1 - Yes,2 - No" style="radio" class="horizontal"/>
                                            </div>
                                        <div class="col-md-3">
                                            <label>Results received as a couple</label>
                                            <obs conceptId="99494" id="99494" answerConceptIds="1065,1066" answerLabels="1 - Yes,2 - No" style="radio" class="horizontal"/>
                                        </div>
                                        <div class="col-md-3">
                                            <label>Couple results:</label>
                                            <obs conceptId="99497" id="99497" answerConceptIds="6096,165173,165174" answerLabels="1 - Discordant Couple,2 - Concordant Negative,3 - Concordant positive"  class="horizontal"/>
                                        </div>

                                    </div>
                                    <div class="row">
                                        <div class="col-md-4">
                                            <label>Client has presumptive TB</label>
                                            <obs conceptId="99498" id="99498" answerConceptIds="1065,1066" answerLabels="1 - Yes,2 - No" style="radio" class="horizontal"/>
                                        </div>
                                        <div class="col-md-4">
                                            <label>Presumptive TB case referred for TB Services</label>
                                            <obs id="165178" conceptId="165178" answerConceptIds="90003,90004" answerLabels="1 - Yes,2 - No" style="radio" class="horizontal"/>

                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="card">
                                <div class="card-header">
                                    Prevention Services and Referral
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <obs conceptId="165177" answerConceptId="99511" answerLabel="1 - Prevention Information" style="checkbox" class="horizontal-layout-options" />
                                            <obs conceptId="165177" answerConceptId="90083" answerLabel="2 - Condoms" style="checkbox" class="horizontal-layout-options" />
                                        </div>
                                        <div class="col-md-3">
                                            <obs conceptId="165177" answerConceptId="99550" answerLabel="3 - STI Screening" style="checkbox" class="horizontal-layout-options" />
                                            <obs conceptId="165177" answerConceptId="99553" answerLabel="4 - STI treatment" style="checkbox" class="horizontal-layout-options" />
                                        </div>
                                        <div class="col-md-3">
                                            <obs conceptId="165177" answerConceptId="165176" answerLabel="5 - Post-GBV" style="checkbox" class="horizontal-layout-options" />
                                            <obs conceptId="165177" answerConceptId="99056" answerLabel="6 - PEP" style="checkbox" class="horizontal-layout-options" />
                                        </div>
                                        <div class="col-md-3">
                                            <obs conceptId="165177" answerConceptId="165163" answerLabel="7 - PREP" style="checkbox" class="horizontal-layout-options" />
                                            <obs conceptId="165177" id="other-prevention-services" answerConceptId="90002" answerLabel="8 - Others" style="checkbox" class="horizontal-layout-options" />
                                            <span><label>Other prevention services</label>
                                                <obs id="165175" conceptId="165175" class="horizontal-layout-options"/>
                                            </span>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <label>Client has been referred for HIV care or other prevention services </label>
                                            <obs id="162982" conceptId="162982" answerConceptIds="1065,1066" answerLabels="1 - Yes,2 - No"  style="radio" class="horizontal"/>
                                        </div>
                                        <div class="col-md-4">
                                            <label>Place of referral</label>
                                            <obs id="90211" conceptId="90211" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-4">
                                    <label><span class="required">*</span>Counselor</label>
                                    <encounterProvider required="true"/>
                                </div>
                            </div>


                        </div>
                        </div>
                </div>



            </div>
        </div>
    </div>
</div>
</htmlform>